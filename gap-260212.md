# FRD Gap Analizi — X-Ray TIR Collimator Design Tool

**Tarih:** 2026-02-12
**Durum:** 445 test, Phase 1-7 tamamlandı

## Özet

| Kategori | Tamamlanan | Eksik | Oran |
|----------|-----------|-------|------|
| Core Physics (§4.2, §7) | 42/42 | 0 | **100%** |
| Geometry & Canvas (§4.1 FR-1.1..1.5) | 28/30 | 2 | 93% |
| Design Management (§4.1 FR-1.6) | 14/19 | 5 | 74% |
| Simulation & Metrics (§4.3 FR-3.1..3.4) | 16/22 | 6 | 73% |
| Compton UI & Charts (§4.3 FR-3.5) | 8/18 | 10 | 44% |
| Reporting & Export (§4.4) | 10/16 | 6 | 63% |
| UI/UX Polish (§6) | 8/12 | 4 | 67% |
| V&V Framework (§11) | 10/12 | 2 | 83% |
| Phase 8 — Packaging | 0/7 | 7 | 0% |

---

## 1. TAMAMLANAN (Implemented & Tested)

### Core Physics (%100)
- Beer-Lambert (tek/çok katman), HVL/TVL, enerji/kalınlık tarama
- Build-up (GP + Taylor + çok katman Kalos)
- NIST XCOM log-log interpolasyon, alaşım mixture rule
- Klein-Nishina dσ/dΩ, σ_KN, Compton kinematiği
- Kahn rejection sampling, scatter ray-tracing, SPR hesaplama
- Spectrum modelleri (Kramers kVp, monoenerjik MeV)
- Birim sistemi (units.py tek dönüşüm noktası)

### Geometry & Canvas (%93)
- 3 şablon (fan/pencil/slit), çok aşamalı mimari (v2.0)
- Sürüklenebilir source/detector, boyut etiketleri
- Katman yönetimi, malzeme renklendirme, kompozit katmanlar
- Grid (1/5/10/50mm), zoom/pan, ruler, resize handles
- Phantom desteği (wire/line-pair/grid + projeksiyon motoru)
- Scatter overlay (turuncu/kırmızı etkileşim noktaları)

### Design Management (%74)
- Save/Load/SaveAs + Ctrl kısayolları
- Otomatik versiyonlama, versiyon geçmişi + geri yükleme
- Thumbnail oluşturma (200×150), favori/etiket
- DesignManagerDialog (filtre, arama, favori)
- .cdt proje dosyası (ZIP arşiv)

### Export (%63)
- JSON geometry (şema migration v1→v2)
- CSV (beam profile + attenuation, BOM UTF-8)
- PDF rapor (Sections A-F, ReportLab)
- PNG canvas export
- .cdt proje arşivi

---

## 2. EKSİKLER (Gaps)

### Kritik — Temel FRD Gereksinimleri

| # | FRD Ref | Gereksinim | Detay |
|---|---------|-----------|-------|
| **G-1** | FR-2.2 | **Enerji preset'leri** | 6 preset tanımlı (Luggage 80kVp, Cargo Low 160kVp, Cargo Med 320kVp, LINAC Low 1MeV, Med 3.5MeV, High 6MeV) — toolbar'da yok |
| **G-2** | FR-2.2 | **kVp / MeV mod seçici** | UI'da enerji modu toggle'ı yok; slider + mod düğmesi gerekli |
| **G-3** | FR-3.2 | **Çok enerjili overlay karşılaştırma** | `compare_energies()` FRD'de tanımlı, beam profile chart'ta multi-energy overlay yok |
| **G-4** | FR-3.5.4 | **SPR profil grafiği tab'ı** | Scatter sonuçları ResultsPanel'de gösterilir ama alt grafik tab'larında SPR profil chart'ı yok |
| **G-5** | FR-1.6.7 | **Not sistemi** | Design ve simulation'lara metin notu ekleme (notes tablosu schema'da var, CRUD yok) |
| **G-6** | §8.1.2 | **LINAC modu uyarısı** | MeV enerji kullanıldığında UI uyarı mesajı gerekli (FRD §8.1.2 zorunlu kılar) |

### Orta — Fonksiyonel Eksikler

| # | FRD Ref | Gereksinim | Detay |
|---|---------|-----------|-------|
| **G-7** | FR-2.4 | **Katman bazlı attenuation tablosu** | Quick Results Panel'de per-layer/per-energy tablo formatı yok (sadece score card var) |
| **G-8** | FR-2.4 | **Build-up ile/siz karşılaştırma** | İki sütunlu build-up ON vs OFF tablo görünümü yok |
| **G-9** | FR-3.3 | **μ/ρ alt bileşen grafikleri** | Attenuation chart'ta photoelectric + Compton + pair production ayrı eğrileri yok |
| **G-10** | FR-3.4.6 | **Kullanıcı tanımlı eşik değerleri** | Quality metric eşikleri constants.py'de sabit, UI'dan düzenlenemez |
| **G-11** | FR-3.5.1 | **Thomson karşılaştırma eğrisi** | KN polar plot'ta klasik Thomson (kesikli çizgi) overlay'ı yok |
| **G-12** | FR-3.5.1 | **Etkileşimli enerji slider'ı** | Compton chart'larda enerji değiştirme slider'ı yok (gerçek zamanlı güncelleme) |
| **G-13** | FR-3.5.1 | **Enerji preset düğmeleri** | Compton tab'ında 80/160/320 keV + 1/3.5/6 MeV hızlı seçim düğmeleri yok |
| **G-14** | FR-3.5.1 | **σ_KN toplam değer gösterimi** | KN chart üzerinde toplam σ_KN (cm²/e, cm²/atom, cm⁻¹) değerleri yok |
| **G-15** | FR-3.5.2 | **Compton edge işaretçisi** | Scattered spectrum chart'ta E'_min dikey çizgi ve etiket yok |
| **G-16** | FR-3.5.3 | **Δλ Compton kayması gösterimi** | Angle-energy map'te dalga boyu kayması (Compton shift) crosshair bilgisi yok |
| **G-17** | FR-5.4 | **material_compton_fractions()** | Malzeme bazlı Compton/toplam oran karşılaştırma chart'ı yok |
| **G-18** | FR-4.3.2 | **SVG canvas export** | ImageExporter sadece PNG; SVG desteği yok |

### PDF Rapor Eksikleri

| # | FRD Ref | Gereksinim | Detay |
|---|---------|-----------|-------|
| **G-19** | FR-4.1 §G | **Section G — Compton Scatter** | KN polar plot, scatter spectrum, SPR profil, toplam scatter istatistikleri |
| **G-20** | FR-4.1 §H | **Section H — Model Varsayımları** | Fizik model özeti, LINAC/scatter sınırlamaları, disclaimer |
| **G-21** | FR-4.1 §I | **Section I — Doğrulama Özeti** | Son benchmark test sonuçları, pass/fail sayıları |
| **G-22** | FR-4.1.1 | **Bölüm seçici dialog** | Checkbox'lu bölüm seçim dialog'u yok (tüm bölümler otomatik dahil) |
| **G-23** | FR-4.1.3 | **Sayfa tahmini preview** | "Tahmini X sayfa" gösterimi yok |

### Phase 8 — Paketleme & Cilalama

| # | FRD Ref | Gereksinim | Detay |
|---|---------|-----------|-------|
| **G-24** | §10 P8 | **PyInstaller .exe/.app** | Tek dosya dağıtım paketi oluşturulmadı |
| **G-25** | §10 P8 | **.cdt dosya ilişkilendirme** | OS dosya türü kaydı yok |
| **G-26** | §10 P8 | **Çoklu platform testi** | Windows/macOS/Linux doğrulaması yapılmadı |
| **G-27** | §10 P8 | **Kullanıcı dokümantasyonu** | README, kullanım kılavuzu yok |
| **G-28** | §6.3 | **F11 tam ekran modu** | Full-screen toggle implementasyonu doğrulanmadı |
| **G-29** | §6.3 | **QSettings layout kaydetme** | Pencere boyutu/panel pozisyonu kalıcı saklama (kısmi) |
| **G-30** | §11.9 | **HTML doğrulama raporu** | `pytest --html=validation_report.html` → PDF Section I bağlantısı yok |

---

## 3. ÖNCELİK MATRİSİ

### P1 — Yüksek (Kullanıcı deneyimini doğrudan etkiler)
- **G-1, G-2**: Enerji preset'leri + kVp/MeV mod seçici
- **G-6**: LINAC uyarı mesajı (FRD zorunlu kılar)
- **G-7**: Katman bazlı attenuation tablosu
- **G-4**: SPR profil grafiği (scatter sonucu görselleştirmesi)

### P2 — Orta (Fonksiyonel zenginlik)
- **G-3**: Multi-energy overlay
- **G-9**: μ/ρ alt bileşen eğrileri
- **G-11, G-12, G-13**: Compton chart interaktivitesi
- **G-19, G-20**: PDF Sections G, H
- **G-5**: Not sistemi

### P3 — Düşük (Cilalama / Phase 8)
- **G-8, G-10**: Build-up karşılaştırma, özelleştirilebilir eşikler
- **G-14-G-18**: Compton detay gösterimleri, SVG export
- **G-21-G-23**: PDF Section I, bölüm seçici, preview
- **G-24-G-30**: Paketleme, dokümantasyon, platform testleri

---

## 4. KAPSAM DIŞI (FRD v2+ / Out of Scope)

FRD §12'de açıkça "gelecek versiyon" olarak işaretli — mevcut scope'ta **değil**:
- Multiple-scatter ray-tracing (full MC)
- 3D görselleştirme (Qt3D/VTK)
- SpekCalc spektrum editörü / CSV import
- MLC (Multi-Leaf Collimator)
- Maliyet optimizasyonu
- i18n (çoklu dil)
- Kullanıcı tanımlı malzeme

---

**Toplam: 30 gap, bunların 4'ü P1 (kritik), 10'u P2 (orta), 16'sı P3 (düşük/Phase 8)**
